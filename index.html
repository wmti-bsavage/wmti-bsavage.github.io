<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!DOCTYPE html>
<html>

<head>
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>

<body>
    <p>V0.11</p>
    <p>This add-in corrects the formatting of any links pointing to the Sales&Quoting directory.</p>
    <button id="helloButton">Change Links</button>
    <a href="\\wmtinas\shared\Sales&Quoteing\Quotes\Albany Engineered Composites\Steel\2023\23-1106 Rev2 Zodiac 767 tooling.xlsx">Quote Link</a>
    <p id="link">Test 1</p>

</body>

</html>

<script>

    Office.initialize = function (reason) {
    $(function () {

        // Set up ItemChanged event
        Office.context.mailbox.addHandlerAsync(Office.EventType.ItemChanged, itemChanged);

        UpdateTaskPaneUI(Office.context.mailbox.item);
    });
    };

    function itemChanged(eventArgs) {

        // Update UI based on the new current item
        UpdateTaskPaneUI(Office.context.mailbox.item);
    }

    function UpdateTaskPaneUI(item)
    {
    // Assuming that item is always a read item (instead of a compose item).
    if (item != null) console.log(item.subject);
    }

    Office.onReady((info) => {
        if (info.host === Office.HostType.Outlook) {

            var body = Office.context.mailbox.item.body;
            // Get the body as text
            body.getAsync(Office.CoercionType.Text, function (asyncResult) {
                if (asyncResult.status !== Office.AsyncResultStatus.Succeeded) {
                    // do something with the error
                }
                else {
                    //$('.result').html(asyncResult.value);
                    document.getElementById("link").innerHTML = asyncResult.value;
                }
            });
        }
    });

</script>